<!DOCTYPE html>
<html>

    <head>
        <title>Clock</title>
        <meta charset="UTF-8">
        <link rel="icon" href="assets/logo.svg"/>
        <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    </head>

    <body>
    
        <svg id="mySVG" version="1.1" viewBox="0  0 500 500" width="600" height="400" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
            
                <circle id="inside-circle" cx="250" cy="210" r="200" fill="none" stroke="black" />
                <circle id="outside-circle" cx="250" cy="210" r="165" fill="none" stroke="black" />
                <g id="hours"></g>

                <g id="path-and-hours">
                    <path id="handSc" d="M 200 200 L 200 300 M 200 300 L 193 340 L 207 340 M 200 340 L 200 350 M 200 300 L 207 340 M 200 230 L 193 220 M 200 230 L 207 220 L 193 220 z" fill="none" stroke="black" transform="rotate(0 200 200)"></path>
                    
                    <path id="handHr" d="M 200 200 L 200 290 M 200 290 L 193 330 M 200 290 L 207 330 L 200 340 L 193 330 M 200 200 L 193 190 M 200 200 L 207 190 L 193 190 z" fill="none" stroke="black" transform="rotate(0 200 200)"></path>
                    
                    

                    <ellipse id="hourBox" cx="200" cy="120" rx="80" ry="50" fill="black" style="opacity:0.1;"/>
                    <text x="135" y="135" fill="red" font-family="Verdana" font-size="45" style="opacity: 0.7;">
                        <tspan id="heureActu">?</tspan>:<tspan id="minuteActu">?</tspan>
                    </text>
                </g>

        </svg>

        <script>

            
            const svg = document.getElementById("mySVG");
            const other=document.getElementById("path-and-hours");
            var hd=document.getElementById("handHr");
            var hn=document.getElementById("handSc");
            var gHours=document.getElementById("hours");
            var h=0;

            var cxVal=200;
            var cyVal=200;

            //change the x and y position of both circles
            circleOne=document.getElementById("inside-circle");
            var r=parseFloat(circleOne.getAttribute("r"));
            
            circleTwo=document.getElementById("outside-circle");
            circleTwo.setAttribute("fill","red");
            circleTwo.setAttribute("style","opacity:0.1;")
            circleOne.setAttribute("cx",cxVal);
            circleTwo.setAttribute("cx",cxVal);
            circleOne.setAttribute("cy",cyVal);
            circleTwo.setAttribute("cy",cyVal);

            var xVal=cxVal-r;
            var yVal=cyVal-r;

            other.setAttribute("transform","translate("+xVal+" "+yVal+")");
            xVal=cyVal-r;
            yVal=r-cxVal;
            gHours.setAttribute("transform","translate("+xVal+" "+yVal+") rotate(-90 "+cxVal+" "+cyVal+")");

            function stroke(rot) {
                let dash = document.createElementNS("http://www.w3.org/2000/svg", "path");
                dash.setAttributeNS(null, "id", "dash");
                dash.setAttributeNS(null, "d", "M 165 0 L "+r+" 0");
                dash.setAttributeNS(null, "transform", "translate("+cxVal+" "+cyVal+") rotate(+" + rot + " 0 0)");
                dash.setAttributeNS(null, "fill", "none");
                dash.setAttributeNS(null, "stroke", "black");
                dash.setAttributeNS(null, "stroke-width", "5");
                svg.appendChild(dash);
            }
 
            function numbers(num,rot) {
                var number=document.createElementNS("http://www.w3.org/2000/svg", "text");
                number.setAttribute("x",353);
                number.setAttribute("y",200);
                number.setAttribute("fill","red");
                number.setAttribute("dominant-baseline","middle");
                number.setAttribute("style","text-anchor:middle; font-family:Helvetica; font-weight: bold; font-size:20px;");
                number.setAttribute("transform","rotate("+rot+" 200 200)");
                var textNode=document.createTextNode(num);
                number.appendChild(textNode);
                gHours.appendChild(number);
            }

            function change() {
                hn.setAttribute("transform","rotate("+h+" 200 200)");
                h=h+1;
            }

            setInterval(change,1000);                    //change position of seconds hand every second 

            for (var i = 0; i < 360; i += 10) stroke(i);
            for (var i=1;i<=24;i++){
                var rot=i*360/24;
                numbers(""+i,rot);
            } 

            function updateTime() {
                var now=new Date();
                var epoch=now.getTime()/1000;
                var h=now.getHours();
                var m=now.getMinutes();
                var s=now.getSeconds();

                document.getElementById("heureActu").innerHTML=h;
                document.getElementById("minuteActu").innerHTML=m;
                //document.getElementById("secondeActu").innerHTML=s;
            }

            function initialise() {
                //the digital time in the ellipse it updated every seconds
                setInterval(updateTime,1000);
            }

            window.onload=initialise;

            var move=document.createElementNS("http://www.w3.org/2000/svg", "animateTransform");
            //creation of the animateTransform and its attributes for the hour hand
            move.setAttribute("attributeName","transform");
            move.setAttribute("attributeType","XML");
            move.setAttribute("type","rotate");
            move.setAttribute("to","360 200 200");
            move.setAttribute("dur","36000s")
            move.setAttribute("repeatCount","indefinite");
            updateHourHand()

            function updateHourHand() {
                var now=new Date();
                var h=now.getHours();
                var m=now.getMinutes();
                var h=h+(m/60);                              //calculate the real time it is actually
                var val=(h-12)*15;                           //every hour value covers an angle of 15 degrees from 12hours
                move.setAttribute("from",""+val+" 200 200"); //position the hour hand at the right angle hence right time
            }
            
           
            hd.appendChild(move);

        </script>
    </body>
    
</html>